<div class="ConfigurationTypes_textpadding">
  <div class="card border-light" *ngIf="openForm">
    <div class="card-header text-white bg-secondary">
      {{ editMode ? "Update" : "Add" }} File Data
    </div>

    <form [formGroup]="mappingForm" (ngSubmit)="onFomSubmit()">
      <div class="container p-2">
        <div class="row align-items-center">
          <!-- Table Name -->
          <div class="col-md-4 col-sm-12">
            <mat-form-field appearance="outline">
              <mat-label>Table</mat-label>
              <input
                type="text"
                matInput
                formControlName="tableName"
                [matAutocomplete]="auto"
                (input)="filterTables(mappingForm.get('tableName')?.value)"
              />
              <mat-autocomplete #auto="matAutocomplete">
                <mat-option *ngFor="let time of filterTable" [value]="time">
                  {{ time }}
                </mat-option>
              </mat-autocomplete>
              <mat-error
                *ngIf="
                  mappingForm.get('tableName')?.touched &&
                  mappingForm.get('tableName')?.invalid &&
                  mappingForm.get('tableName')?.hasError('required')
                "
                class="error"
                >Table is required</mat-error
              >
            </mat-form-field>
          </div>

          <!--  File Name -->
          <div class="col-md-4 col-sm-12">
            <mat-form-field appearance="outline">
              <mat-label>File</mat-label>
              <input matInput formControlName="fileName" />
              <mat-error
                *ngIf="
                  mappingForm.get('fileName')?.touched &&
                  mappingForm.get('fileName')?.invalid &&
                  mappingForm.get('fileName')?.hasError('required')
                "
                class="error"
                >File Name is required</mat-error
              >
            </mat-form-field>
          </div>
        </div>

        <div class="row">
          <div class="col-md-6"></div>
          <div class="col-md-6">
            <div class="mb-3 mt-1 pt-1 float-end">
              <button
                type="submit"
                class="btn btn-outline-secondary btn-rounded d-inline-block m-2"
              >
                {{ editMode ? "Update" : "Add" }}
              </button>
              <button
                type="button"
                class="btn btn-outline-secondary btn-rounded d-inline-block m-2"
                (click)="onCloseForm()"
              >
                Cancel
              </button>
            </div>
          </div>
        </div>
      </div>
    </form>
  </div>

  <h4 cl>File Data</h4>
  <div class="clearfix"></div>

  <div class="table-responsive-container">
    <div class="table-scroll-container">
      <table
        mat-table
        [dataSource]="this.filterData.dataSource"
        matSort
        class="mat-elevation-z8 mat-datagrid w-100"
        aria-label="users"
      >
        <ng-container matColumnDef="sno">
          <th mat-header-cell *matHeaderCellDef style="width: 30px" scope="col">
            <label mat-sort-header for="sno-input"> S.No </label>
            <input
              type="text"
              id="sno-input"
              (keyup)="updatePagination()"
              [(ngModel)]="filterData.filterColumnNames[0].Value"
              [filter]="filterData"
            />
          </th>
          <td mat-cell *matCellDef="let element">{{ element.sno }}</td>
        </ng-container>

        <ng-container matColumnDef="tableName">
          <th mat-header-cell *matHeaderCellDef scope="col">
            <label mat-sort-header for="scheduler-name-input"> Table </label>
            <input
              type="text"
              id="scheduler-name-input"
              (keyup)="updatePagination()"
              [(ngModel)]="filterData.filterColumnNames[1].Value"
              [filter]="filterData"
            />
          </th>
          <td mat-cell *matCellDef="let element">
            {{ element.tableName }}
          </td>
        </ng-container>

        <ng-container matColumnDef="fileName">
          <th mat-header-cell *matHeaderCellDef scope="col">
            <label mat-sort-header for="start-date-input"> File </label>
            <input
              type="text"
              id="start-date-input"
              (keyup)="updatePagination()"
              [(ngModel)]="filterData.filterColumnNames[2].Value"
              [filter]="filterData"
            />
          </th>
          <td mat-cell *matCellDef="let element">
            {{ element.fileName }}
          </td>
        </ng-container>
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef scope="col">
            <span> Actions </span>
          </th>
          <td mat-cell *matCellDef="let element">
            <mat-slide-toggle
              [checked]="element.status == '0' ? false : true"
              (change)="onActivatescheduler(element, $event)"
            ></mat-slide-toggle>
            <span
              matTooltip="Edit"
              (click)="onEditScheduler(element)"
              (keydown)="onEditScheduler(element)"
            >
              <i class="fas fa-pencil-alt" aria-hidden="true"></i>
            </span>
            <span
              matTooltip="Delete"
              style="cursor: pointer"
              (click)="onSchedulerDelete(element)"
              (keydown)="onSchedulerDelete(element)"
            >
              <i class="far fa-trash-alt" aria-hidden="true"></i>
            </span>
            <span
              *ngIf="!element.isSchedulerRunning"
              matTooltip="Start"
              style="cursor: pointer"
              (click)="onStartScheduler(element)"
              (keydown)="onStartScheduler(element)"
            >
              <i class="fas fa-play" aria-hidden="true"></i>
            </span>
            <span
              style="cursor: none; pointer-events: none"
              *ngIf="element.isSchedulerRunning"
              matTooltip="Running"
              style="cursor: pointer"
            >
              <i class="fas fa-spinner fa-spin" aria-hidden="true"></i>
            </span>
            <span
              style="cursor: none; pointer-events: none"
              *ngIf="element.isSchedulerRunning"
              matTooltip="Stop"
              style="cursor: pointer"
              (click)="onStopScheduler(element)"
              (keydown)="onStartScheduler(element)"
            >
              <i class="fas fa-times-circle" aria-hidden="true"></i>
            </span>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>
      <mat-paginator
        [pageSizeOptions]="[10, 25, 50, 100]"
        aria-label="Select page"
      >
      </mat-paginator>
    </div>
  </div>
</div>
